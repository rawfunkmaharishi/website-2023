---
const { count, infinite } = Astro.props;
---

<script define:vars={{ count: count, infinite: infinite }}>
  const prevButton = document.getElementById("slide-arrow-prev");
  const nextButton = document.getElementById("slide-arrow-next");

  var counter = 0;
  showSlide(counter);
  refreshButtonStyles();

  if (infinite) {
    nextButton.addEventListener("click", () => {
      hideCurrent();
      counter = (counter + 1) % count;
      showSlide(counter);
    });

    prevButton.addEventListener("click", () => {
      hideCurrent();
      counter = (counter - 1 + count) % count;
      showSlide(counter);
    });
  } else {
    nextButton.addEventListener("click", () => {
      if (counter < count - 1) {
        hideCurrent();
        counter += 1;
        showSlide(counter);
      }
      refreshButtonStyles();
    });

    prevButton.addEventListener("click", () => {
      if (counter > 0) {
        hideCurrent();
        counter -= 1;
        showSlide(counter);
      }
      refreshButtonStyles();
    });
  }

  function refreshButtonStyles() {
    if (!infinite) {
      if (counter == 0) {
        prevButton.classList.add("dead");
      } else {
        prevButton.classList.remove("dead");
      }

      if (counter == count - 1) {
        nextButton.classList.add("dead");
      } else {
        nextButton.classList.remove("dead");
      }
    }
  }

  function hideCurrent() {
    slide = document.querySelector(".current-slide")
    slide.classList.remove("current-slide")
    slide.style.display = "none"
  }

  function showSlide(index) {
    slide = document.getElementById("slide-" + index);
    slide.style.display = "inline";
    slide.classList.add("current-slide")
  }
</script>

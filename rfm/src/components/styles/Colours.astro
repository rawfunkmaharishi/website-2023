---
import {
  palette as lightPalette,
  choices as lightChoices,
} from "../../conf/palettes/820263-d90368-eadeda-2e294e-ffd400";

import {
  palette as darkPalette,
  choices as darkChoices,
} from "../../conf/palettes/a31621-fcf7f8-ced3dc-4e8098-90c2e7";

function rgbise(triple) {
  return "rgb(" + triple.join(", ") + ")"
}

function RGBs(palette, choices, background) {
  const data = Object.assign(
    {},
    ...Object.keys(choices).map(function (key) {
      return {
        [key]: rgbise(palette[choices[key]].rgb),
      };
    })
  );
  data.background = rgbise(background);

  return data;
}

const colours = {
  light: (RGBs(lightPalette, lightChoices, [255, 255, 255])),
  dark: (RGBs(darkPalette, darkChoices, [0, 0, 0])),
};

var bloc = "";

for (var key in colours) {
  bloc += "@media (prefers-color-scheme: ";
  bloc += key;
  bloc += ") {\n";

  bloc += "  :root {\n";

  for (var subKey in colours[key]) {
    bloc += "    --colour-";
    bloc += subKey;
    bloc += ": ";
    bloc += colours[key][subKey];
    bloc += ";\n";
  }

  bloc += "  }\n"

  bloc += "}\n";
}
---

<style set:html={bloc}></style>

---
import Layout from "../layouts/Layout.astro";
import { fetchFromAPI } from "../lib/tools";

const records = await fetchFromAPI("records").then(function (records) {
  return records.reverse().map((record) => {
    return {
      href: record.url,
      year: record.datePublished.split("-").slice(0, 1)[0],
      name: record.name,
      image: record.image.contentUrl,
    };
  });
});
---

<Layout title="Records">
  <ul>
    {
      records.map((record) => (
        <li>
          <div class="record">
            <h2>
              {record.name} <small>({record.year})</small>
            </h2>
            <a href={record.href}>
              <img src={record.image} />
            </a>
          </div>
        </li>
      ))
    }
  </ul>
</Layout>

<style>
  img {
    width: 20vw;
  }

  ul {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    align-items: center;
  }

  li {
    margin: auto;
    padding-bottom: 1rem;
    flex-basis: 40%;
  }

  @media only screen and (max-width: 600px) {
    img {
      width: 70vw;
    }
  }
</style>

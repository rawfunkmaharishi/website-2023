---
import Layout from "../layouts/Layout.astro";
import Slider from "../components/Slider.astro";

import { fetchFromAPI, spliceIntoChunks } from "../lib/tools";

const allVideos = await fetchFromAPI("gigs")
  .then(function (gigs) {
    return gigs.reverse().filter((item) => "recordedIn" in item);
  })
  .then(function (videos) {
    return videos.map((video) => {
      return {
        href: video.url.replace("/gigs", "/videos"),
        date: video.startDate,
        name: video.location.name,
      };
    });
  });



const videos = spliceIntoChunks(allVideos, 4);
---

<Layout title="Videos">
  <Slider items={videos} slideType="video" />
</Layout>

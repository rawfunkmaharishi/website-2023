---
import { fetchFromAPI } from "../../lib/tools";

import Layout from "../../layouts/Layout.astro";
import PaginatedLinks from "../../components/PaginatedLinks.astro";

export async function getStaticPaths({ paginate }) {
  const videos = await fetchFromAPI("gigs")
    .then(function (gigs) {
      return gigs.reverse().filter((item) => "recordedIn" in item);
    })
    .then(function (videos) {
      return videos.map((video) => {
        return {
          href: video.url.replace("/gigs", "/videos"),
          date: video.startDate.slice(0, 10),
          name: video.location.name,
        };
      });
    });
  return paginate(videos, { pageSize: 4 });
}

const { page } = Astro.props;
---

<Layout title="Videos">
  <PaginatedLinks page={page} dateFormat="MMMM YYYY" />
</Layout>
